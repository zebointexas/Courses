    public void doJobQuery(String sqlStmt, PrintWriter out)
    throws SQLException, IOException, ServletException {

        OracleDataSource ods = new OracleDataSource();
        ods.setURL("jdbc:oracle:oci8:" + constStruct.USERNAME + "/" + constStruct.PASSWORD + "@" + constStruct.DATABASE);
        Connection conn = ods.getConnection();

        // Query the employee names 
        Statement stmt = conn.createStatement();
        ResultSet rset = stmt.executeQuery(sqlStmt);

        // Found the number of columns
        ResultSetMetaData rsmd = rset.getMetaData();
        numberOfColumns = rsmd.getColumnCount();

        rowPreFetch = ((OracleStatement) stmt).getRowPrefetch();
        columnTypes = new int[numberOfColumns + 1];
        columnTypeNames = new String[numberOfColumns + 1];

        //String c = new String(rsmd.getColumnType(1));
        for (int i = 1; i <= numberOfColumns; i++) {

            //c += " " + new String(rsmd.getColumnType(i));
            columnTypes[i] = rsmd.getColumnType(i);
            columnTypeNames[i] = rsmd.getColumnTypeName(i);
        }

        //queryRows = new String [constStruct.MAX_ROW_NUMBER];
        resultRows = new String[constStruct.MAX_MATCH_NUMBER][];

        int tmpRating;
        int j = 0, k = 0;
        String currentRow[];
        while (rset.next()) {

            //resultRows[j] = new String [numberOfColumns+1];
            //String r = new String(rset.getString(1));
            //String r1 = new String(r);
            //resultRows[j][1] = r;
            currentRow = new String[numberOfColumns + 1];
            currentRow[1] = new String(rset.getString(1));

            // Retrieve all columns of current row
            for (int i = 2; i <= numberOfColumns; i++) {
                currentRow[i] = rset.getString(i);
                //currentRow[i] = new String(rset.getString(1));
            }

            //out.println("CONSIDER row: " + j + " with " + currentRow[1] + " and city=" + currentRow[8]);
            tmpRating = computeAJobRating(currentRow, out);

            //out.println("Back from computeAJobRating with tmpRating="+tmpRating);
            if (tmpRating > 0) {
                resultRows[j] = currentRow;
                rating[j++] = tmpRating;
            }
        }
        //close the result set, statement, and the connection
        rset.close();
        stmt.close();
        conn.close();

        numberOfMatchedRows = j;

        sortResultRows(out);

    } // End of doJobQuery 
